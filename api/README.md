API Changelog
=============

This is a public record of the BillForward API changelog

API Changelog
=============

This is a public record of the BillForward API changelog

### 1.2015.161

**TOC**

* New Features
  * Pricing Component Charges
  * Invoice issuance Behaviour
  * Synchronous API endpoints
  * Quotes
  * Time Control

* Breaking Changes to Existing Features
  * Subscriptions
  * Trials
  * Rate Plan

* Non-breaking Changes to Existing Features
  * Product Rate Plans
  * Trials
  * Invoices
  * Pricing Components
  * Subscriptions
  * Synchronous execution of Amendments


# New Features

## Pricing Component Charges

Any costs associated with Pricing Components are now modeled as Charges.  Charges may be generated by the system when a Subscription enters a new period or may be generated in an ad hoc manner.  For example, one could create an ad hoc Charge for '5 widgets' where 'widgets' is the Pricing Component name and 5 is the quantity.

Changing the value or time period of a Charge may result in a change of price.  To make this new price take effect the Charge must be re-calculated.

## Invoice issuance Behaviour

The Invoice Issuance Behaviour dictates the state of an Invoice when it is created, either **Pending** or **Unpaid**.  This is specified on Product Rate Plans.

There are three types of Issuance Behaviour:

* Manual - all Invoices are created in the 'Pending' state.

* Immediate - all Invoices are created in the 'Unpaid' state. **(DEFAULT)**

* Delayed - all Invoices are created in the 'Pending' state and will be moved to the 'Unpaid' state (issued) after a defined period of time i.e. 1 Day

## Synchronous API endpoints

We have implemented synchronous endpoints for numerous system actions.  These endpoints return the outcome of their operation immediately — removing the need to listen for webhooks or poll the API. The new endpoints are listed below:

<table>
  <tr>
    <td>Documentation</td>
    <td>Endpoint</td>
    <td>Verb</td>
  </tr>
  <tr>
    <td>Void Charge</td>
    <td>/charges/{charge-id}</td>
    <td>DELETE</td>
  </tr>
  <tr>
    <td>Recalculate Charge</td>
    <td>/charges/{charge-id}/recalculate</td>
    <td>POST</td>
  </tr>
  <tr>
    <td>Invoice Outstanding Charges</td>
    <td>/subscriptions/{subscription-id}/invoice-charges</td>
    <td>POST</td>
  </tr>
  <tr>
    <td>Cancel Subscription</td>
    <td>/subscriptions/{subscription-id}/cancel</td>
    <td>POST</td>
  </tr>
  <tr>
    <td>Migrate Subscription</td>
    <td>/subscriptions/{subscription-id}/migrate</td>
    <td>POST</td>
  </tr>
  <tr>
    <td>Recalculate Invoice</td>
    <td>/invoices/{invoice-id}/recalculate</td>
    <td>POST</td>
  </tr>
  <tr>
    <td>Retry Invoice Execution</td>
    <td>/invoices/{invoice-id}/execute</td>
    <td>POST</td>
  </tr>
  <tr>
    <td>Void Invoice</td>
    <td>/invoices/{invoice-id}</td>
    <td>DELETE</td>
  </tr>
</table>


## Quotes

The new Quoting system enables prices to be calculated for the cost of creating a new Subscription, performing an upgrade / downgrade, migrating to a new Product Rate Plan etc.

[https://app-sandbox.billforward.net/#/api/method/quotes](https://app-sandbox.billforward.net/#/api/method/quotes)

## Time Control

Time control is a set of endpoints which provides the ability to move a particular Subscription forwards in time by a number of periods or to a specific date.

To learn more about Time Control take a look at the docs:

[https://app-sandbox.billforward.net/#/api/method/time](https://app-sandbox.billforward.net/#/api/method/time)

# 

# Breaking Changes to Existing Features

## Subscriptions

Product Rate Plans are no longer returned on Subscriptions when querying the API;

## Trials

Trial Invoices now have a zero total cost.

## Rate Plan

Historically if a rate-plan had usage components it would automatically have an Invoice issuance Behaviour of **Delayed**, this now defaults to a value of **Immediate** to maintain the existing behaviour when creating the rate plan set the value to **Delayed.**

## Products

Product names are now enforced as unique within your organization.


# Non-breaking Changes to Existing Features

## Product Rate Plans

The duration of a Product Rate Plan is now specified on the Product Rate Plan itself.  Previously it was only defined on a Product.  Products may now be thought of as Product Rate Plan groups; they act as a template to create new Product Rate Plans.  The duration and trial specified on a Product may be overridden when creating a new Product Rate Plan.

## Trials

Trials are now defined on a Product Rate Plan with default values being specified on the associated Product. When a subscription is of type **Trial**, any charges that are created will have the **trial** flag set to **true**.  When an Invoice is created for these Charges they will receive a 100% discount.  This will result in an Invoice with zero total cost, but with all other values the same (as though the Subscription were not currently in a trial).

## Invoices

Invoice costs are now calculated by summing the costs of associated Charges.  This change in behaviour enables several powerful new features.

Charges may be added and removed from an invoice which allows its value to be easily altered.  Changing the value or amount of a Charge will be reflected in the overall value of the Invoice it's associated with but will not affect the pricing of the Subscription.

Re-calculating an Invoice only re-associates its Charges.  To change the price one must alter the value of a Charge and re-calculate it.

Backwards compatibility has been maintained so that usage may continue to be set as it was previously.

## Pricing Components

There is a new API endpoint which may be used to set Pricing Component Values:

[https://app-sandbox.billforward.net/#/api/method/subscriptions/POST?path=%2Fsubscriptions%2F%7Bsubscription-ID%7D%2Fvalues%2F%7Bpricing-component%7D](https://app-sandbox.billforward.net/#/api/method/subscriptions/POST?path=%2Fsubscriptions%2F%7Bsubscription-ID%7D%2Fvalues%2F%7Bpricing-component%7D)

This is now the recommended way to set and alter the values associated with a Subscription.  This endpoint may be used to initially set Pricing Component Values and then subsequently to perform upgrades and downgrades.  If possible this endpoint will execute synchronously.

When performing cost calculations the default value of a Pricing Component will be used if no Pricing Component Value exists for the specified subscription

This endpoint can be used for any pricing component type. For usage it will set the value for the current ongoing period.

## Subscriptions

When starting a Subscription, if it has a 'current period start' equal to the current time or earlier, then the Invoice for its first period will be generated and executed immediately (synchronously).

## Synchronous execution of Amendments

The Amendments system has been updated to execute Amendments synchronously when the â€˜actioning timeâ€™ is equal to the current time or earlier.  As with thnew synchronous endpoints described above this removes the need to listen for webhooks.


>   Released to: sandbox (2014/07/01 13:12 +00:00)

>   Released to: production TBC


### 1.2015.104

-   Add support for the Sage Pay payment gateway
-   API improvements for default payment methods


>   Released to sandbox (2015/04/20 13:00 +00:00)

>   Released to production (2015/04/21 14:15 +00:00)


### 1.2015.100

-   Added in CSV, PDF, and HTML export for invoices
-   Improved export table Invoices export
-   Minor fix for default payment methods
-   Fax, VAT number added to profile


>   Released to sandbox (2015/03/10 19:00 +12:00)

>   Released to production (2015/03/10 19:00 +12:00)


### 1.2015.075

-   Improved receipts for Stripe ACH


>   Released to sandbox (2015/03/12 13:00 +12:00)

>   Released to production (2015/03/14 12:00 +12:00)


### 1.2015.068

-   Bug where two payment methods could be marked as default for the same account
-   No longer allow deleted payment methods to be default
-   Bug handling coupons in the final invoice generated when a subscription expires


>   Released to sandbox (2015/03/09 13:00 +12:00)

>   Released to production (2015/03/09 17:17 +12:00)


### 1.2015.062

-   Unpaid invoices may be returned to the 'Pending' state
-   Invoices may now be marked as 'Paid' without taking any payment


>   Released to sandbox (2015/03/03 13:00 +00:00)

>   Released to production (2015/03/04 17:17 +00:00)


### 1.2015.027

-   Add 'companyName' to profiles
-   Introduced new simplified coupon endpoints to the API
-   Introduced default payment methods
-   Introduced default tax
-   Simplified payment method API endpoints
-   Simplified tax API endpoints
-   General API improvements
-   Add semantic meaning to ids, i.e. ACC-B48AE...


>   Released to sandbox (2015/02/09 16:00 +00:00)

>   Released to production (2015/02/12 14:37 +00:00)


### 1.2015.014

-   General performance improvements
-   Logging improvements for the Braintree Payment Gateway
-   Improved search


>   Released to sandbox (2015/01/14 17:54 +00:00)

>   Released to production (2015/01/22 12:30 +00:00)


### 1.2014.296 

-   Simplification of Refund and Coupon API - [docs](https://app-sandbox.billforward.net/#/api/method/refunds)
-   Bug when generating multiple Stripe refunds
-   Bug in setup components fixed
-   Bug in handling of Stripe ACH webhooks


>   Released to: sandbox (2014/12/16 18:12 +00:00)

>   Released to: production (2014/12/17 12:30 +00:00)<200b>
